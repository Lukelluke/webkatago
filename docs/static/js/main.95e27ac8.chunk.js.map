{"version":3,"sources":["SituationBar.js","GoBoard.js","GoPosition.js","Gtp.js","GoBoardController.js","serviceWorker.js","index.js"],"names":["SituationBar","props","style","width","height","borderStyle","borderWidth","borderColor","marginBottom","blackStyle","float","textAlign","color","concat","blackPercent","backgroundColor","whiteStyle","react_default","a","createElement","blackInfo","whiteInfo","GoIntersectionState","Object","classCallCheck","this","stone","number","winrate","playouts","fillColor","range","start","end","result","i","push","GoBoard","x","y","w","_this","intersection","intersections","index","GoBoard_GoIntersection","key","onClick","onClickIntersection","onMouseEnter","onMouseEnterIntersection","onMouseLeave","onMouseLeaveIntersection","_this2","goBoardStyle","className","parseInt","h","map","renderIntersection","React","Component","GoIntersection","url","n","intersectionStyle","backgroundImage","infoStyle","sprintf","PureComponent","EMPTY","BLACK","WHITE","opponentOf","Marker","boardSize","BOARD_SIZE","BOARD_SIZE2","value","marks","Int32Array","point","HANDICAPS","GoPosition","handicap","_this$state","state","defineProperty","Float32Array","recent8","marker1","marker2","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","xy","setState","xyToPoint","err","return","turn","ko","source","set","sgf","_jssgf$fastParse","jssgf","fastParse","root","slicedToArray","p","SZ","node","_children","length","move","B","W","play","apply","moveToXy","s","offset","charCodeAt","string","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","points","e","opponent","captives","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","adjacenciesAt","pt","getState","stringAt","liberties","removeString","GoString","clear","mark","isMarked","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","opponents","unshift","pop","putRecent8","switchTurn","captureBy","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","undoPlay","Math","floor","pointToXy","_i","_arr","_i2","_arr2","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","o","os","escape","ss","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","tryToCapture","canEscape","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","adjacencies","every","stack","arguments","likeEye","numBadDiagonal","allowableBadDiagonal","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","diagonalsAt","d","indexOf","isEyeOfTurn","Gtp","inputDom","document","getElementById","outputDom","addEventListener","event","process","currentTarget","str","command","dispatchEvent","CustomEvent","Promise","res","rej","getAttribute","LzAnalyzeHandler","resolve","reject","_command","interval","handler","kataAnalyzeHandler","line","startsWith","parseLzAnalyze","parseKataAnalyze","match","regex","exec","visits","prior","lcb","orer","pv","split","info","ownership","utility","parseFloat","radius","scoreMean","scoreStdev","utilibyLcb","order","trim","coord2xy","coord","c","slice","xy2coord","HSVtoRGB","v","r","g","b","f","q","t","round","RGBtoHSV","max","min","darker","board2intersections","board","Array","GoBoardController","size","byoyomi","gtp","model","candidates","candidate","percent","_ref","asyncToGenerator","regenerator_default","_callee","wrap","_context","prev","clipboardData","window","getData","FS","writeFile","fromSgf","kataAnalyze","stop","_x","render","lzAnalyze","variationIntersections","addCandidatesInfo","blackWinrate","black","toFixed","white","_this3","first","blackScore","console","log","_context2","t0","includes","_this4","ReactDOM","src_SituationBar","src_GoBoard_0","maxPlayouts","toConsumableArray","maxWinrate","greenHue","cyanHue","entries","_ref4","_ref3","percentPlayouts","logPlayouts","hue","alpha","borderCoor","_this5","find","position","copy","textColor","addOwnership","_ref7","_ref6","_this$model$pointToXy","_this$model$pointToXy2","_ref10","_ref9","_this$model$pointToXy3","_this$model$pointToXy4","Boolean","location","hostname","SharedArrayBuffer","goBoardController","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.95e27ac8.chunk.js","sourcesContent":["/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React from 'react';\n\nfunction SituationBar(props) {\n    const style = {\n        width: props.width,\n        height: \"15px\",\n        borderStyle: \"solid\",\n        borderWidth: \"1px\",\n        borderColor: \"black\",\n        marginBottom: \"5px\",\n    }\n    const blackStyle = {\n        float: \"left\",\n        textAlign: \"center\",\n        color: \"white\",\n        width: `${props.blackPercent}%`,\n        height: \"100%\",\n        backgroundColor: \"black\",\n    }\n    const whiteStyle = {\n        float: \"left\",\n        textAlign: \"center\",\n        width: `${100 - props.blackPercent}%`,\n        height: \"100%\",\n    }\n    return (\n        <div style={style}>\n        <div style={blackStyle}>{props.blackInfo}</div>\n        <div style={whiteStyle}>{props.whiteInfo}</div>\n        </div>\n    );\n}\n\nexport default SituationBar;","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React from 'react';\nimport './GoBoard.css';\nimport { sprintf } from \"sprintf-js\";\n\nfunction shortStringOfInteger(n) {\n    if (n < 1000) {\n        return sprintf('%d', n);\n    } else if (n < 10000) {\n        return sprintf('%.1fk', n / 1000);\n    } else if (n < 1000000) {\n        return sprintf('%.0fk', n / 1000);\n    } else if (n < 10000000) {\n        return sprintf('%.1fM', n / 1000000);\n    } else if (n < 1000000000) {\n        return sprintf('%.0fM', n / 1000000);\n    } else {\n        return sprintf('%.0G', n / 1000000000);\n    }\n}\n\nexport class GoIntersectionState {\n    constructor() {\n        this.stone = null;\n        this.number = null;\n        this.winrate = null;\n        this.playouts = null;\n        this.fillColor = null;\n        this.borderWidth = null;\n        this.borderColor = null;\n        this.backgroundColor = null;\n    }\n}\n\nfunction range(start, end) {\n    const result = [];\n    if (start <= end) {\n        for (let i = start; i <= end; i++) {\n            result.push(i);\n        }\n    } else {\n        for (let i = start; i >= end; i--) {\n            result.push(i);\n        }\n    }\n    return result;\n}\n\nclass GoBoard extends React.Component {\n    index(x, y) {\n        return this.props.w * (y - 1) + x - 1;\n    }\n\n    /*, number, winrate, visits, backgroundColor, borderColor) {\n\n    }*/\n\n    renderIntersection(x, y) {\n        const intersection = this.props.intersections[this.index(x, y)];\n        return (\n            <GoIntersection\n                key={`${x}-${y}`}\n                onClick={() => this.props.onClickIntersection(x, y)}\n                onMouseEnter={() => this.props.onMouseEnterIntersection(x, y)}\n                onMouseLeave={() => this.props.onMouseLeaveIntersection(x, y)}\n                stone={intersection.stone}\n                number={intersection.number}\n                winrate={intersection.winrate}\n                playouts={intersection.playouts}\n                fillColor={intersection.fillColor}\n                borderColor={intersection.borderColor}\n                backgroundColor={intersection.backgroundColor}\n            />\n        );\n    }\n\n    render() {\n        const goBoardStyle = {\n            width: this.props.width,\n            height: this.props.height,\n        };\n        return (\n            <div className=\"go-board\" style={goBoardStyle}>\n            <div className=\"go-board-content\">\n                {range(parseInt(this.props.h), 1).map(y => (\n                    <div className=\"go-row\" key={y}>\n                        {range(1, parseInt(this.props.w)).map(x => this.renderIntersection(x, y))}\n                    </div>\n                ))}\n            </div>\n            </div>\n        );\n    }\n}\n\nclass GoIntersection extends React.PureComponent {\n    render() {\n        let url;\n        switch (this.props.stone) {\n            case \"B\":\n            url = \"url(https://storage.googleapis.com/mimiaka-storage/mimiaka/public/images/nachiguro2.png)\";\n            break;\n            case \"W\":\n            url = \"url(https://storage.googleapis.com/mimiaka-storage/mimiaka/public/images/hamaguri2.png)\";\n            break;\n            default:\n            url = null;\n        }\n        const intersectionStyle = {\n            color: this.props.stone === \"B\" ? \"white\" : \"black\",\n            backgroundImage: url,\n            backgroundColor: this.props.backgroundColor,\n        }\n        const infoStyle = {\n            backgroundColor: this.props.fillColor,\n            borderWidth: this.props.borderWidth,\n            borderColor: this.props.borderColor,\n        }\n        return (\n            <div className=\"go-intersection\" style={intersectionStyle} onClick={this.props.onClick} onMouseEnter={this.props.onMouseEnter} onMouseLeave={this.props.onMouseLeave}>\n                <div className=\"go-intersection-number\">{this.props.number}</div>\n                <div className=\"go-intersection-info\" style={infoStyle}>\n                    <div>{this.props.winrate}</div>\n                    <div>{typeof this.props.playouts === \"number\" ? shortStringOfInteger(this.props.playouts) : this.props.playouts}</div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default GoBoard;\n","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\n import jssgf from \"jssgf\";\n\nexport const PASS = -1;\nexport const EMPTY = 0;\nexport const BLACK = 1;\nexport const WHITE = 2;\n\nexport function opponentOf(color) {\n    switch (color) {\n        case BLACK:\n            return WHITE;\n        case WHITE:\n            return BLACK;\n        default:\n            return EMPTY;\n    }\n}\n\nclass Marker {\n    constructor(boardSize) {\n        this.BOARD_SIZE = boardSize;\n        this.BOARD_SIZE2 = boardSize * boardSize;\n        this.value = 0;\n        this.marks = new Int32Array(this.BOARD_SIZE2);\n    }\n\n    clear() {\n        this.value += 1;\n    }\n\n    isMarked(point) {\n        return this.marks[point] === this.value;\n    }\n\n    mark(point) {\n        this.marks[point] = this.value;\n    }\n}\n\nconst HANDICAPS = [\n    [],\n    [],\n    [[16, 4], [4, 16]],\n    [[16, 4], [4, 16], [16, 16]],\n    [[16, 4], [4, 16], [16, 16], [4, 4]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [10, 10]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10], [10, 10]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10], [10, 4], [10, 16]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10], [10, 4], [10, 16], [10, 10]],\n];\n\n\nclass GoPosition {\n    static copy(source) {\n        const result = new GoPosition(source.BOARD_SIZE, 0);\n        result.state[BLACK].set(source.state[BLACK]);\n        result.state[WHITE].set(source.state[WHITE]);\n        result.turn = source.turn;\n        result.ko = source.ko;\n        return result;\n    }\n\n    static fromSgf(sgf) {\n        const [root] = jssgf.fastParse(sgf);\n        const p = new this(parseInt(root.SZ || '19'));\n        let node = root;\n        while (node._children.length > 0) {\n            node = node._children[0];\n            let move;\n            if (node.B != null) {\n                move = node.B;\n            } else if (node.W != null) {\n                move = node.W;\n            } else {\n                continue;\n            }\n            p.play(p.xyToPoint.apply(p, p.moveToXy(move)));\n        }\n        return p\n    }\n\n    constructor(boardSize, handicap) {\n        this.BOARD_SIZE = boardSize;\n        this.BOARD_SIZE2 = boardSize * boardSize;\n        this.state = {\n            [BLACK]: new Float32Array(this.BOARD_SIZE2),\n            [WHITE]: new Float32Array(this.BOARD_SIZE2)\n        }\n        this.recent8 = [];\n        this.marker1 = new Marker(boardSize);\n        this.marker2 = new Marker(boardSize);\n        if (handicap > 1) {\n            for (const xy of HANDICAPS[handicap]) {\n                this.setState(this.xyToPoint(xy[0], xy[1]), BLACK);\n            }\n            this.turn = WHITE;\n        } else {\n            this.turn = BLACK;\n        }\n        this.ko = null;\n    }\n\n    moveToXy(s) {\n        if (s === '') {\n            return PASS;\n        }\n        const offset = 'a'.charCodeAt(0) - 1;\n        return [s.charCodeAt(0) - offset, this.BOARD_SIZE - (s.charCodeAt(1) - offset) + 1];\n    }\n    \n    \n    opponent() {\n        return opponentOf(this.turn);\n    }\n\n    switchTurn() {\n        this.turn = opponentOf(this.turn);\n    }\n\n    getState(point) {\n        if (this.state[BLACK][point] === 1.0) {\n            return BLACK;\n        }\n        if (this.state[WHITE][point] === 1.0) {\n            return WHITE;\n        }\n        return EMPTY;\n    }\n\n    setState(point, color) {\n        if (color === EMPTY) {\n            this.state[BLACK][point] = 0.0;\n            this.state[WHITE][point] = 0.0;\n        } else {\n            this.state[color][point] = 1.0;\n        }\n    }\n\n    removeString(string) {\n        for (const e of string.points) {\n            this.setState(e, EMPTY);\n        }\n    }\n\n    captureBy(point) {\n        const opponent = this.opponent();\n        const captives = [];\n        for (const pt of this.adjacenciesAt(point)) {\n            if (this.getState(pt) === opponent) {\n                const string = this.stringAt(pt);\n                if (string.liberties.length === 0) {\n                    this.removeString(string);\n                    captives.push.apply(captives, string.points);\n                }\n            }\n        }\n        return captives;\n    }\n\n    stringAt(point) {\n        const color = this.getState(point);\n        if (color === EMPTY) {\n            return null;\n        }\n        const opponent = opponentOf(color);\n        const string = new GoString();\n\n        this.marker1.clear();\n        this.marker2.clear();\n        string.points.push(point);\n        this.marker2.mark(point);\n        for (let index = 0; index < string.points.length; index++) {\n            const pt = string.points[index];\n            if (!this.marker1.isMarked(pt)) {\n                this.marker1.mark(pt);\n                for (const a of this.adjacenciesAt(pt)) {\n                    if (!this.marker1.isMarked(a)) {\n                        const state = this.getState(a);\n                        if (state === color) {\n                            if (!this.marker2.isMarked(a)) {\n                                string.points.push(a);\n                                this.marker2.mark(a);\n                            }\n                        } else {\n                            this.marker1.mark(a);\n                            if (state === opponent) {\n                                string.opponents.push(a);\n                            } else {\n                                string.liberties.push(a);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return string;\n    }\n\n    putRecent8(point) {\n        this.recent8.unshift(point);\n        if (this.recent8.length > 8) {\n            this.recent8.pop();\n        }\n    }\n\n    play(point) {\n        if (point === PASS) {\n            this.putRecent8(point);\n            this.switchTurn();\n            return {\n                turn: this.turn,\n                point,\n                ko: this.ko,\n                captives: []\n            };\n        }\n        if (point === this.ko || this.getState(point) !== EMPTY) { // 着手禁止\n            return null;\n        }\n        this.setState(point, this.turn);\n\n        const captives = this.captureBy(point);\n        const string = this.stringAt(point);\n        const liberties = string.liberties.length;\n        if (liberties === 0) { // 着手禁止\n            this.setState(point, EMPTY); // restore\n            return null;\n        }\n        const ko = this.ko;\n        if (captives.length === 1 && liberties === 1 && string.points.length === 1) {\n            this.ko = string.liberties[0];\n        } else {\n            this.ko = null;\n        }\n        this.putRecent8(point);\n        const turn = this.turn;\n        this.switchTurn();\n        return { turn, point, ko, captives, string };\n    }\n\n    undoPlay(move) {\n        this.ko = move.ko;\n        this.switchTurn();\n        if (move.point === PASS) {\n            return;\n        }\n        this.setState(move.point, EMPTY);\n        const opponent = opponentOf(move.turn);\n        for (const p of move.captives) {\n            this.setState(p, opponent);\n        }\n    }\n\n    isLegal(point) {\n        const move = this.play(point);\n        if (move) {\n            this.undoPlay(move);\n            return true;\n        }\n        return false;\n    }\n\n    xyToPoint(x, y) {\n        return (x - 1) + (y - 1) * this.BOARD_SIZE;\n    }\n\n    pointToXy(point) {\n        const y = Math.floor(point / this.BOARD_SIZE);\n        const x = point - y * this.BOARD_SIZE;\n        return [x + 1, y + 1];\n    }\n\n    adjacenciesAt(point) {\n        const xy = this.pointToXy(point);\n        const result = [];\n        for (const e of [[0, -1], [-1, 0], [1, 0], [0, 1]]) {\n            const x = xy[0] + e[0];\n            const y = xy[1] + e[1];\n            if (x >= 1 && x <= this.BOARD_SIZE && y >= 1 && y <= this.BOARD_SIZE) {\n                result.push(this.xyToPoint(x, y));\n            }\n        }\n        return result;\n    }\n\n    diagonalsAt(point) {\n        const xy = this.pointToXy(point);\n        const result = [];\n        for (const e of [[-1, -1], [-1, 1], [1, -1], [1, -1]]) {\n            const x = xy[0] + e[0];\n            const y = xy[1] + e[1];\n            if (x >= 1 && x <= this.BOARD_SIZE && y >= 1 && y <= this.BOARD_SIZE) {\n                result.push(this.xyToPoint(x, y));\n            }\n        }\n        return result;\n    }\n\n    canEscape(string) {\n        if (string.liberties.length > 1) { // アタリじゃない\n            return true;\n        }\n        for (const o of string.opponents) { // 相手の石を取って逃げる\n            const os = this.stringAt(o);\n            if (os.liberties.length === 1) { // アタリの石\n                const escape = this.play(os.liberties[0]);\n                if (!escape) { // 着手禁止\n                    continue;\n                }\n                const ss = this.stringAt(string.points[0]); // stringの更新\n                if (ss.liberties.length === 2) { // 取ってもまだシチョウ\n                    for (const o of ss.liberties) {\n                        const tryToCapture = this.play(o);\n                        if (!tryToCapture) {\n                            continue;\n                        }\n                        const result = this.canEscape(this.stringAt(ss.points[0]));\n                        this.undoPlay(tryToCapture);\n                        if (!result) {\n                            this.undoPlay(escape);\n                            return false;\n                        }\n                    }\n                    this.undoPlay(escape);\n                    return true;\n                } else {\n                    this.undoPlay(escape);\n                    return ss.liberties.length > 2;\n                }\n            }\n        }\n        const escape = this.play(string.liberties[0]);\n        if (!escape) {\n            return false;\n        }\n        if (escape.string.liberties.length === 2) {\n            for (const o of escape.string.liberties) {\n                const tryToCapture = this.play(o);\n                if (!tryToCapture) {\n                    continue;\n                }\n                const ss = this.stringAt(string.points[0]);\n                const result = this.canEscape(ss);\n                this.undoPlay(tryToCapture);\n                if (!result) {\n                    this.undoPlay(escape);\n                    return false;\n                }\n            }\n            this.undoPlay(escape);\n            return true;\n        } else {\n            this.undoPlay(escape);\n            return escape.string.liberties.length !== 1;\n        }\n    }\n\n    likeEye(point) {\n        if (this.getState(point) !== EMPTY) {\n            return false;\n        }\n        const adjacencies = this.adjacenciesAt(point);\n        if (!adjacencies.every(p => this.getState(p) === this.turn)) {\n            return false;\n        }\n        return adjacencies.every(p => this.stringAt(p).liberties.length > 1);\n    }\n\n    isEyeOfTurn(point, stack=[]) {\n        if (!this.likeEye(point)) {\n            return false;\n        }\n        let numBadDiagonal = 0;\n        const allowableBadDiagonal = this.adjacenciesAt(point).length === 4 ? 1 : 0;\n\n        const opponent = opponentOf(this.turn);\n        for (const d of this.diagonalsAt(point)) {\n            if (this.getState(d) === opponent) {\n                numBadDiagonal += 1;\n            } else if (this.getState(d) === EMPTY && stack.indexOf(d) < 0) {\n                stack.push(point);\n                if (!this.isEyeOfTurn(d, stack)) {\n                    numBadDiagonal += 1;\n                }\n                stack.pop();\n            }\n            if (numBadDiagonal > allowableBadDiagonal) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    isFalseEye(point) {\n        return this.likeEye(point) && !this.isEyeOfTurn(point);\n    }\n\n    toString() {\n        let string ='';\n        for (let y = 1; y <= this.BOARD_SIZE; y++) {\n            for (let x = 1; x <= this.BOARD_SIZE; x++) {\n                switch (this.getState(this.xyToPoint(x, y))) {\n                    case EMPTY:\n                        string += '.';\n                        break;\n                    case BLACK:\n                        string += 'X';\n                        break;\n                    case WHITE:\n                        string += 'O';\n                        break;\n                    default:\n                }\n            }\n            string += '\\n';\n        }\n        return string;\n    }\n}\n\nclass GoString {\n    constructor() {\n        this.points = [];\n        this.liberties = [];\n        this.opponents = [];\n    }\n}\n\nexport default GoPosition;","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nclass Gtp {\n    constructor() {\n        this.inputDom = document.getElementById(\"input\");\n        this.outputDom = document.getElementById(\"output\");\n        this.outputDom.addEventListener(\"message\", event => {\n            this.process(event.currentTarget.value);\n            event.currentTarget.value = \"\";\n        }, false);\n    }\n    _command(str) {\n        this.inputDom.command.value = str;\n        // submitメソッドはイベントハンドラを走らせない。\n        this.inputDom.dispatchEvent(new CustomEvent('submit'));\n    }\n    command(str) {\n        return new Promise((res, rej) => {\n            if (this.inputDom.command.getAttribute(\"disabled\") != null) {\n                return;\n            }\n            this.LzAnalyzeHandler = null;\n            this.resolve = res;\n            this.reject = rej;\n            this._command(str);\n        });\n    }\n    lzAnalyze(interval, handler) {\n        if (this.inputDom.command.getAttribute(\"disabled\") != null) {\n            return;\n        }\n        this.LzAnalyzeHandler = handler;\n        this._command(`lz-analyze ${interval}`);\n    }\n    kataAnalyze(interval, handler) {\n        if (this.inputDom.command.getAttribute(\"disabled\") != null) {\n            return;\n        }\n        this.kataAnalyzeHandler = handler;\n        this._command(`kata-analyze ${interval} ownership true`);\n    }\n    process(line) {\n        if (line.startsWith(\"=\")) {\n            if (this.resolve) {\n                this.resolve(line);\n                this.resolve = null;;\n            }\n        } else if (line.startsWith(\"?\")) {\n            if (this.reject) {\n                this.reject(line);\n                this.reject = null;;\n            }\n        }\n        if (this.LzAnalyzeHandler) {\n            this.parseLzAnalyze(line);\n        }\n        if (this.kataAnalyzeHandler) {\n            this.parseKataAnalyze(line);\n        }\n    }\n    parseLzAnalyze(line) {\n        // info move C4 visits 2 winrate 4861 prior 1307 lcb -5139 order 0 pv C4 Q17 info move Q17 visits 2 winrate 4905 prior 1098 lcb -5095 order 1 pv Q17 Q3 info move Q3 visits 2 winrate 4870 prior 1089 lcb -5130 order 2 pv Q3 Q17 info move Q4 visits 2 winrate 4934 prior 915 lcb -5066 order 3 pv Q4 Q17 info move Q16 visits 2 winrate 4940 prior 900 lcb -5060 order 4 pv Q16 Q3 info move D3 visits 0 winrate 4120 prior 853 lcb -5880 order 5 pv D3\n        const regex = /info move ([A-Z]\\d{1,2}) visits (\\d+) winrate (\\d+) prior (-?\\d+) lcb (-?\\d+) order (\\d+) pv ((:? ?[A-Z]\\d{1,2})+)/g;\n        const result = [];\n        let match;\n        while ((match = regex.exec(line)) != null) {\n            result.push({\n                move: match[1],\n                visits: parseInt(match[2]),\n                winrate: parseInt(match[3]) / 10000,\n                prior: parseInt(match[4]),\n                lcb: parseInt(match[5]),\n                orer: parseInt(match[6]),\n                pv: match[7].split(\" \")\n            });\n        }\n        this.LzAnalyzeHandler(result);\n    }\n    parseKataAnalyze(line) {\n        // info move C16 visits 56 utility -0.0194507 radius 0.00739696 winrate 0.491428 scoreMean -0.478044 scoreStdev 32.3095 prior 0.105269 lcb 0.488786 utilityLcb -0.0268477 order 0 pv C16 D3 R16 Q3 info move Q17 visits 53 utility -0.0205986 radius 0.00789271 winrate 0.490967 scoreMean -0.51843 scoreStdev 32.3086 prior 0.103317 lcb 0.488148 utilityLcb -0.0284914 order 1 pv Q17 R4 C4 D17 info move R16 visits 48 utility -0.0213819 radius 0.00722001 winrate 0.490688 scoreMean -0.558307 scoreStdev 32.284 prior 0.0935492 lcb 0.48811 utilityLcb -0.0286019 order 2 pv R16 D17 Q3 C4 info move Q3 visits 48 utility -0.02044 radius 0.00754151 winrate 0.491073 scoreMean -0.52743 scoreStdev 32.2601 prior 0.0914671 lcb 0.48838 utilityLcb -0.0279815 order 3 pv Q3 C4 C16 Q17 info move D17 visits 46 utility -0.0203694 radius 0.00863686 winrate 0.491095 scoreMean -0.523149 scoreStdev 32.3207 prior 0.0878046 lcb 0.48801 utilityLcb -0.0290062 order 4 pv D17 C4 R4 R16 info move C4 visits 45 utility -0.0197793 radius 0.00917776 winrate 0.491299 scoreMean -0.49066 scoreStdev 32.3245 prior 0.0849676 lcb 0.488021 utilityLcb -0.028957 order 5 pv C4 D17 R4 Q17 info move R4 visits 44 utility -0.0194629 radius 0.00811152 winrate 0.491457 scoreMean -0.490883 scoreStdev 32.3008 prior 0.0829457 lcb 0.488561 utilityLcb -0.0275745 order 6 pv R4 D3 D17 Q17 info move D3 visits 31 utility -0.0191221 radius 0.0111833 winrate 0.491607 scoreMean -0.48426 scoreStdev 32.3926 prior 0.0578495 lcb 0.487613 utilityLcb -0.0303054 order 7 pv D3 R16 Q3 C16 info move Q4 visits 22 utility -0.0124166 radius 0.0190799 winrate 0.494289 scoreMean -0.244886 scoreStdev 32.3341 prior 0.035389 lcb 0.487475 utilityLcb -0.0314966 order 8 pv Q4 C16 Q17 info move D16 visits 21 utility -0.011348 radius 0.0169283 winrate 0.494768 scoreMean -0.224796 scoreStdev 32.3515 prior 0.0329591 lcb 0.488722 utilityLcb -0.0282763 order 9 pv D16 R4 Q17 info move Q16 visits 20 utility -0.0146187 radius 0.0177249 winrate 0.493477 scoreMean -0.347622 scoreStdev 32.3037 prior 0.034737 lcb 0.487147 utilityLcb -0.0323436 order 10 pv Q16 R4 C4 D17 info move D4 visits 18 utility -0.0106007 radius 0.0247917 winrate 0.495063 scoreMean -0.197694 scoreStdev 32.4116 prior 0.026451 lcb 0.486209 utilityLcb -0.0353924 order 11 pv D4 D17 R16 ownership 0.0574604 0.0927184 0.0862007 0.0889222 0.0713715 0.0705342 0.0663168 0.0699454 0.0696961 0.0703135 0.0707498 0.0720875 0.0683848 0.0697193 0.0657052 0.0811097 0.0803288 0.0891219 0.0589881 0.09508 0.0887696 0.0856517 0.0567618 0.0538765 0.0454831 0.037413 0.0424316 0.0418428 0.0414332 0.0427052 0.0438007 0.0401999 0.0443078 0.04858 0.0488899 0.0744198 0.0782437 0.0795875 0.0927124 0.0970239 0.068805 0.0359063 0.027807 0.040289 0.0323884 0.0359301 0.0319725 0.0286396 0.0314628 0.0330162 0.0307161 0.0350543 0.0235283 0.020687 0.0460025 0.073326 0.0802772 0.102314 0.0730797 0.0559703 0.0428388 0.0478558 0.0374339 0.0321411 0.0350915 0.032562 0.0320581 0.0322501 0.0338105 0.0301837 0.029372 0.0364939 0.0338301 0.0170987 0.0471682 0.0860232 0.0806405 0.06963 0.0410239 0.0474705 0.0264108 0.028095 0.0277513 0.0269129 0.025512 0.0257056 0.0253849 0.0268678 0.0262896 0.0218693 0.0223549 0.0386803 0.0254255 0.0511993 0.0714695 0.0758416 0.0510583 0.039525 0.0360652 0.0254357 0.024569 0.0223601 0.0146071 0.0127407 0.0131719 0.0130609 0.0145692 0.020976 0.0232113 0.0236705 0.0341295 0.038488 0.0405238 0.0703722 0.0724104 0.0408933 0.0345678 0.033456 0.0273286 0.0214489 0.0109052 0.00227355 1.36716e-05 7.0059e-05 -0.000410544 0.00066663 0.00918381 0.0199694 0.0284545 0.0308396 0.0304586 0.0345143 0.0668094 0.072015 0.0414706 0.0365848 0.0383315 0.0287511 0.014852 0.00129122 -0.00670995 -0.0096296 -0.00890338 -0.009229 -0.00681303 0.00073803 0.0125068 0.0282436 0.033793 0.0327075 0.0415581 0.0722434 0.0677752 0.0390562 0.0333236 0.0353017 0.0260784 0.0115204 -0.0021702 -0.0113931 -0.0153548 -0.0147816 -0.014332 -0.0103502 -0.00193408 0.0102372 0.0246196 0.0313203 0.0286652 0.0404499 0.071719 0.0652687 0.0371737 0.0271852 0.0320029 0.0244574 0.0101729 -0.00306306 -0.0122747 -0.0168854 -0.0162893 -0.0162496 -0.0113587 -0.00237764 0.00981343 0.0236747 0.0300972 0.0250575 0.0373618 0.071067 0.0634167 0.0371166 0.0251066 0.0275254 0.0212085 0.00748802 -0.00544358 -0.0136066 -0.0178959 -0.0181945 -0.0177597 -0.0128457 -0.00337375 0.00914089 0.0226917 0.0299255 0.0269413 0.0340216 0.0690287 0.0610828 0.0350292 0.0234277 0.0245448 0.0195385 0.00625186 -0.00509413 -0.011918 -0.0136773 -0.0126529 -0.0125938 -0.00954261 -0.00163155 0.0104468 0.0230677 0.0297651 0.0248561 0.0325079 0.0667663 0.0530989 0.0241485 0.0167402 0.0170874 0.0144973 0.0102617 0.00225149 -0.00486142 -0.00583227 -0.00427596 -0.00443261 -0.00260952 0.00667355 0.0165172 0.0215436 0.0231393 0.0177754 0.0248205 0.0616455 0.0496837 0.0235134 0.0107289 0.0131149 0.00576788 0.0106886 0.0100019 0.00467538 0.00352945 0.00487139 0.00469349 0.00734111 0.014891 0.0163271 0.0148882 0.0227564 0.0179868 0.0292976 0.0605091 0.0454176 0.0215302 -0.00957254 0.00772825 0.00449392 0.00775453 0.013559 0.0158508 0.0147453 0.0162791 0.0170412 0.0195928 0.0195486 0.0157745 0.0127525 0.0227294 0.0123397 0.0336789 0.0560846 0.0524011 0.00537971 -0.0367772 0.0201121 0.00255268 0.00633342 0.0112068 0.0194867 0.0195896 0.0213024 0.021994 0.0238675 0.0197127 0.0185881 0.0267457 0.0271527 0.00493118 0.0321386 0.0680206 0.0320382 0.0248312 -0.0121598 -0.0560937 -0.016586 0.0033388 0.010258 0.0191786 0.0191341 0.0169894 0.0206722 0.0221256 0.0157605 0.0197785 0.0122782 -0.00640326 0.0215207 0.0570617 0.0569199 0.0235893 0.0244588 0.0171742 -0.00940123 0.00497656 0.0136249 0.0109796 0.0211825 0.0241471 0.0261304 0.0284791 0.0278052 0.0240433 0.0307363 0.0356951 0.0270279 0.0523358 0.0552047 0.0552847 -0.00718682 0.0239468 0.0142311 0.0338551 0.0278807 0.0416977 0.0494086 0.0593436 0.0604753 0.0625834 0.0626572 0.0633467 0.0566236 0.0559152 0.0495887 0.0620285 0.051852 0.0538323 0.0218319\n        const regex = /info move ([A-Z]\\d{1,2}) visits (\\d+) utility (-?\\d+\\.\\d+(?:e-?\\d+)?) radius (-?\\d+\\.\\d+(?:e-?\\d+)?) winrate (-?\\d+\\.\\d+(?:e-?\\d+)?) scoreMean (-?\\d+\\.\\d+(?:e-?\\d+)?) scoreStdev (-?\\d+\\.\\d+(?:e-?\\d+)?) prior (-?\\d+\\.\\d+(?:e-?\\d+)?) lcb (-?\\d+\\.\\d+(?:e-?\\d+)?) utilityLcb (-?\\d+\\.\\d+(?:e-?\\d+)?) order (-?\\d+) pv ((?: ?[A-Z]\\d{1,2})+)/g;\n        const result = {\n            info: [],\n            ownership: []\n         };\n        let match;\n        while ((match = regex.exec(line)) != null) {\n            result.info.push({\n                move: match[1],\n                visits: parseInt(match[2]),\n                utility: parseFloat(match[3]),\n                radius: parseFloat(match[4]),\n                winrate: parseFloat(match[5]),\n                scoreMean: parseFloat(match[6]),\n                scoreStdev: parseFloat(match[7]),\n                prior: parseFloat(match[8]),\n                lcb: parseFloat(match[9]),\n                utilibyLcb: parseFloat(match[10]),\n                order: parseInt(match[11]),\n                pv: match[12].split(\" \")\n            });\n        }\n        if ((match = line.match(/ownership((?: -?\\d+\\.\\d+(?:e-?\\d+)?)+)/)) != null) {\n            result.ownership = match[1].trim().split(\" \");\n        };\n        this.kataAnalyzeHandler(result);\n    }\n}\n\nexport default Gtp;","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n/* global FS */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport SituationBar from './SituationBar';\nimport GoBoard, { GoIntersectionState } from './GoBoard';\nimport GoPosition, { BLACK, WHITE, opponentOf } from './GoPosition';\nimport Gtp from \"./Gtp.js\";\nimport { fstat } from 'fs';\n\nfunction coord2xy(coord) {\n    const c = coord.charCodeAt(0);\n    const x = (c < \"I\".charCodeAt(0) ? c + 1 : c) - \"A\".charCodeAt(0);\n    return [x, parseInt(coord.slice(1))];\n}\n\nfunction xy2coord(x, y) {\n    const COORD = [\"@\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\"];\n    return COORD[x] + y;\n}\n\n/* accepts parameters\n * h  Object = {h:x, s:y, v:z}\n * OR \n * h, s, v\n*/\nfunction HSVtoRGB(h, s, v) {\n    let r, g, b, i, f, p, q, t;\n    if (arguments.length === 1) {\n        s = h.s;\n        v = h.v;\n        h = h.h;\n    }\n    i = Math.floor(h * 6);\n    f = h * 6 - i;\n    p = v * (1 - s);\n    q = v * (1 - f * s);\n    t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n        case 0:\n        r = v;\n        g = t;\n        b = p;\n        break;\n        case 1: r = q;\n        g = v;\n        b = p;\n        break;\n        case 2:\n        r = p;\n        g = v;\n        b = t;\n        break;\n        case 3:\n        r = p;\n        g = q;\n        b = v;\n        break;\n        case 4:\n        r = t;\n        g = p;\n        b = v;\n        break;\n        case 5:\n        r = v;\n        g = p;\n        b = q;\n        break;\n        default:\n        break;\n    }\n    return {\n        r: Math.round(r * 255),\n        g: Math.round(g * 255),\n        b: Math.round(b * 255)\n    };\n}\n\n/* accepts parameters\n * r  Object = {r:x, g:y, b:z}\n * OR \n * r, g, b\n*/\nfunction RGBtoHSV(r, g, b) {\n    if (arguments.length === 1) {\n        g = r.g;\n        b = r.b;\n        r = r.r;\n    }\n    let max = Math.max(r, g, b);\n    let min = Math.min(r, g, b);\n    let d = max - min;\n    let h;\n    let s = (max === 0 ? 0 : d / max);\n    let v = max / 255;\n\n    switch (max) {\n        case min:\n        h = 0;\n        break;\n        case r:\n        h = (g - b) + d * (g < b ? 6: 0);\n        h /= 6 * d;\n        break;\n        case g:\n        h = (b - r) + d * 2;\n        h /= 6 * d;\n        break;\n        case b:\n        h = (r - g) + d * 4;\n        h /= 6 * d;\n        break;\n        default:\n        break;\n    }\n\n    return {\n        h: h,\n        s: s,\n        v: v\n    };\n}\n\nfunction darker(r, g, b) {\n    const ratio = 0.7;\n    if (arguments.length === 1) {\n        r = r.r;\n        g = r.g;\n        b = r.b;\n    }\n    return {\n        r: r * ratio,\n        g: g * ratio,\n        b: b * ratio,\n    }\n}\n\n\nfunction board2intersections(board) {\n    const intersections = new Array(board.BOARD_SIZE2);\n    for (let i = 0; i < intersections.length; i++) {\n        const intersection  = new GoIntersectionState();\n        switch (board.getState(i)) {\n            case BLACK:\n            intersection.stone = \"B\";\n            break;\n            case WHITE:\n            intersection.stone = \"W\";\n            break;\n            default:\n        }\n        intersections[i] = intersection;\n    }\n    return intersections;\n}\n\nclass GoBoardController {\n    constructor() {\n        this.size = 19;\n        this.byoyomi = 3;\n        this.gtp = new Gtp();\n        this.model = new GoPosition(this.size, 0);\n        this.candidates = [];\n        this.ownership = null;\n        this.candidate = null;\n        this.info = {\n            percent: 50,\n        };\n        document.getElementById(\"sgf\").addEventListener(\"paste\", async e => {\n            const sgf = (e.clipboardData || window.clipboardData).getData('text');\n            const file = \"tmp.sgf\";\n            FS.writeFile(file, sgf);\n            await this.gtp.command(`loadsgf ${file}`);\n            this.model = GoPosition.fromSgf(sgf);\n            this.kataAnalyze();\n        }, false);\n        const intersections = board2intersections(this.model);\n        this.render(intersections);\n    }\n    \n    lzAnalyze() {\n        this.gtp.lzAnalyze(100, result => {\n            this.candidates = result;\n            let intersections;\n            if (this.candidate) {\n                intersections = this.variationIntersections();\n            } else {\n                intersections = board2intersections(this.model);\n                this.addCandidatesInfo(intersections, result);\n            }\n            const blackWinrate = (this.model.turn === BLACK ? result.winrate : 1 - result.winrate) * 100;\n            this.info.percent = blackWinrate;\n            this.info.black = `${blackWinrate.toFixed(1)}%`;\n            this.info.white = `${(100 - blackWinrate).toFixed(1)}%`;\n            if (intersections) {\n                this.render(intersections);\n            }\n        });\n    }\n\n    kataAnalyze() {\n        this.gtp.kataAnalyze(100, result => {\n            if (result.info.length === 0) {\n                return;\n            }\n            this.candidates = result.info;\n            this.ownership = result.ownership;\n            let intersections;\n            if (this.candidate) {\n                intersections = this.variationIntersections();\n            } else {\n                intersections = board2intersections(this.model);\n                this.addCandidatesInfo(intersections, result.info);\n            }\n            const first = result.info[0];\n            const blackWinrate = (this.model.turn === BLACK ? first.winrate : 1.0 - first.winrate) * 100;\n            const blackScore = (this.model.turn === BLACK ? first.scoreMean : 1.0 - first.scoreMean).toFixed(1);\n            const scoreStdev = first.scoreStdev.toFixed(1)\n            this.info.percent = blackWinrate;\n            if (blackWinrate >= 50) {\n                this.info.black = `${blackWinrate.toFixed(1)}%(${blackScore}±${scoreStdev})`;\n                this.info.white = `${(100 - blackWinrate).toFixed(1)}%`;\n            } else {\n                this.info.black = `${blackWinrate.toFixed(1)}%`;\n                this.info.white = `${(100 - blackWinrate).toFixed(1)}%(${-blackScore}±${scoreStdev})`;\n            }\n            if (intersections) {\n                this.render(intersections);\n            }\n        });\n    }\n\n    async play(x, y) {\n        try {\n            this.model.play(this.model.xyToPoint(x, y));\n            this.render(board2intersections(this.model));\n            await this.gtp.command(`play ${this.model.turn === BLACK ? \"black\" : \"white\"} ${xy2coord(x, y)}`);\n            this.kataAnalyze();\n        } catch (e) {\n            console.log(e);\n        }\n    }\n\n    onMouseEnterIntersection(x, y) {\n        const coord = xy2coord(x, y);\n        if (this.candidates.map(e => e.move).includes(coord)) {\n            this.candidate = coord;\n            const intersections = this.variationIntersections();\n            this.render(intersections);\n        }\n    }\n\n    onMouseLeaveIntersection(x, y) {\n        if (this.candidate) {\n            this.candidate = null;\n            const intersections = board2intersections(this.model);\n            this.addCandidatesInfo(intersections, this.candidates);\n            this.render(intersections);\n        }\n    }\n\n    render(intersections) {\n        const size = \"500px\";\n        ReactDOM.render(\n        <div>\n            <SituationBar\n                width={size}\n                blackPercent={this.info.percent}\n                blackInfo={this.info.black}\n                whiteInfo={this.info.white}\n            />\n            <GoBoard\n                width={size}\n                height={size}\n                w={this.size}\n                h={this.size}\n                intersections={intersections}\n                onClickIntersection={(x, y) => this.play(x, y)}\n                onMouseEnterIntersection={(x, y) => this.onMouseEnterIntersection(x, y)}\n                onMouseLeaveIntersection={(x, y) => this.onMouseLeaveIntersection(x, y)}\n            />\n        </div>\n        , document.getElementById('root'));\n    }\n\n    addCandidatesInfo(intersections, candidates) {\n        const maxPlayouts = Math.max(...candidates.map(e => e.visits));\n        const maxWinrate = Math.max(...candidates.map(e => e.winrate));\n        const saturation = 0.75;\n        const brightness = 0.85;\n        const maxAlpha = 240;\n        const minAlpha = 32;\n        const hueFactor = 3.0;\n        const alphaFactor = 5.0;\n        const greenHue = RGBtoHSV(0, 255, 0).h;\n        const cyanHue = RGBtoHSV(0, 255, 255).h;\n        for (const [i, candidate] of candidates.entries()) {\n            const intersection = intersections[this.model.xyToPoint.apply(this.model, coord2xy(candidate.move))];\n            intersection.winrate = (candidate.winrate * 100).toFixed(1);\n            intersection.playouts = candidate.visits;\n    \n            const percentPlayouts = intersection.playouts / maxPlayouts;\n            const logPlayouts = Math.log(percentPlayouts);\n            const hue = i === 0 ?  cyanHue : greenHue * Math.max(0, logPlayouts / hueFactor + 1);\n            const alpha = ((minAlpha + (maxAlpha - minAlpha) * Math.max(0, logPlayouts / alphaFactor + 1))) / 255;\n            const color = HSVtoRGB(hue, saturation, brightness);\n            if (i === 0) {\n                if (candidate.winrate < maxWinrate) {\n                    intersection.borderWidth = \"2px\";\n                    intersection.borderCoor = \"red\";\n                } else {\n                    intersection.borderWidth = \"1px\";\n                    const c = darker(color);\n                    intersection.borderCoor = `rgba(${c.r},${c.g},${c.b},${alpha})`;\n                }\n            } else if (intersection.winrate === maxWinrate) {\n                intersection.borderWidth = \"2px\";\n                intersection.borderCoor = \"blue\";\n            }\n            intersection.fillColor = `rgba(${color.r},${color.g},${color.b},${alpha})`;\n        }\n    }\n    \n    variationIntersections() {\n        const info = this.candidates.find(e => e.move === this.candidate);\n        if (!info) {\n            return null;\n        }\n        const position = GoPosition.copy(this.model);\n        for (const move of info.pv) {\n            position.play(position.xyToPoint.apply(position, coord2xy(move)));\n        }\n        const intersections = board2intersections(position);\n        let turn = this.model.turn;\n        const first = intersections[position.xyToPoint.apply(position, coord2xy(info.pv[0]))];\n        first.winrate = info.winrate.toFixed(1);\n        first.playouts = info.visits;\n        first.textColor = turn === BLACK ? \"white\" : \"black\";\n        let number = 2;\n        turn = opponentOf(turn);\n        for (const move of info.pv.slice(1)) {\n            const intersection = intersections[position.xyToPoint.apply(position, coord2xy(move))]\n            intersection.number = number;\n            intersection.textColor = turn === BLACK ? \"white\" : \"black\";\n            turn = opponentOf(turn);\n            number++;\n        }\n        if (info.order === 0 && this.ownership) {\n            this.addOwnership(intersections, this.ownership);\n        }\n        return intersections;\n    }\n\n    addOwnership(intersections, ownership) {\n        if (this.model.turn === BLACK) {\n            for (const [i, v] of ownership.entries()) {\n                if (i >= this.model.BOARD_SIZE2) {\n                    break;\n                }\n                const value = v * 0.5;\n                const [x, y] = this.model.pointToXy(i);\n                const intersection = intersections[this.model.BOARD_SIZE * (this.model.BOARD_SIZE - y) + (x - 1)];\n                intersection.backgroundColor = value > 0.0 ? `rgba(0,0,0,${value})` : `rgba(255,255,255,${-value})`;\n            }\n        } else {\n            for (const [i, value] of ownership.entries()) {\n                if (i >= this.model.BOARD_SIZE2) {\n                    break;\n                }\n                const [x, y] = this.model.pointToXy(i);\n                const intersection = intersections[this.model.BOARD_SIZE * (this.model.BOARD_SIZE - y) + (x - 1)];\n                intersection.backgroundColor = value < 0.0 ? `rgba(0,0,0,${-value})` : `rgba(255,255,255,${value})`;\n            }\n        }\n    }\n}\n\nexport default GoBoardController;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport './index.css';\nimport GoBoardController from './GoBoardController';\nimport * as serviceWorker from './serviceWorker';\n\nif (typeof SharedArrayBuffer !== \"undefined\") {\n    window.goBoardController = new GoBoardController();\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}